.row.admin__intro
  .col-sm-12
    %h1 Users

.row.admin__actions
  .col-sm-12
    = link_to 'Invite One User', new_admin_user_path, class: 'btn btn-primary'
    = link_to 'Import Multiple Users', new_admin_user_import_path, class: 'btn btn-primary'
    = link_to 'Invitation Requests', admin_invitation_requests_path, class: 'btn btn-primary'

.row.admin__search
  .col-sm-12
    = form_for  [:admin, @user_search], url: admin_users_path, html: { method: 'GET', class: 'form-inline' } do |form|
      .form-group
        = form.search_field :keyword, placeholder: 'Name or email', class: 'form-control', style: 'min-width: 300px;'
        = form.collection_select :source, user_sources, :first, :last, {prompt: 'Source', include_blank: @user_search.source.present?}, class: 'form-control'
        = form.collection_select :beta_round, beta_rounds, :first, :last, {prompt: 'Beta Round', include_blank: @user_search.beta_round.present?}, class: 'form-control'
        %button.btn.btn-primary
          %i.glyphicon.glyphicon-search
          Search
        = link_to 'Clear Search (Show All)', admin_users_path, class: 'btn btn-default'

.row
  .col-md-12
    %table.table
      %thead
        %tr
          %th Name
          %th Email
          %th Access
          %th Account Status
          %th Invitation Expires
          %th Source
          %th Beta Round
          %th

      %tbody
        - @users.each do |user|
          %tr
            %td= user.full_name
            %td= user.email
            %td= user.admin? ? 'Admin' : 'Regular'
            %td= user.active? ? 'Active' : 'Pending Confirmation'
            %td= user.activation_token_expires_at&.strftime("%-m/%-d/%Y")
            %td= user_sources[user.source]
            %td= beta_rounds[user.beta_round]
            %td
              - unless user.active?
                = link_to 'Resend Invitation', resend_invitation_admin_user_path(user, context_params), class: 'btn btn-default btn-xs', method: :post
              = link_to 'Edit', edit_admin_user_path(user), class: 'btn btn-default btn-xs'
              = link_to 'Delete', admin_user_path(user, context_params), :method => :delete, :data => { :confirm => "Are you sure you want to delete this account?" }, class: 'btn btn-danger btn-xs'

    = paginate @users